<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sky.mapper.PostMapper">

    <insert id="insertPost" parameterType="com.sky.dto.PostDTO">
        INSERT INTO parking.posts (user_id, title, content)
        VALUES (#{userId}, #{title}, #{content})
    </insert>

    <insert id="insertComment" parameterType="com.sky.dto.CommentDTO">
        INSERT INTO parking.comments (post_id, user_id, parent_comment_id, content)
        VALUES (#{postId}, #{userId}, #{parentCommentId}, #{content})
    </insert>

    <insert id="insertLike" parameterType="com.sky.dto.LikeDTO">
        INSERT INTO parking.likes (post_id, user_id)
        VALUES (#{postId}, #{userId})
    </insert>

    <insert id="insertFavorite" parameterType="com.sky.dto.FavoriteDTO">
        INSERT INTO parking.favorites (post_id, user_id)
        VALUES (#{postId}, #{userId})
    </insert>

    <delete id="deletePost" parameterType="java.lang.Integer">
        DELETE FROM parking.posts WHERE post_id = #{postId}
    </delete>

    <delete id="deleteComment" parameterType="java.lang.Integer">
        DELETE FROM parking.comments WHERE comment_id = #{commentId}
    </delete>

    <select id="getPostById" parameterType="java.lang.Integer" resultType="com.sky.entity.Posts">
        SELECT * FROM parking.posts WHERE post_id = #{postId}
    </select>

    <select id="getCommentsByPostId" parameterType="java.lang.Integer" resultType="com.sky.entity.Comments">
        SELECT * FROM parking.comments WHERE post_id = #{postId}
    </select>

    <select id="getLikeByPostAndUser" parameterType="com.sky.dto.LikeDTO" resultType="com.sky.entity.Likes">
        SELECT * FROM parking.likes WHERE post_id = #{postId} AND user_id = #{userId}
    </select>

    <select id="getFavoriteByPostAndUser" parameterType="com.sky.dto.FavoriteDTO" resultType="com.sky.entity.Favorites">
        SELECT * FROM parking.favorites WHERE post_id = #{postId} AND user_id = #{userId}
    </select>

</mapper>